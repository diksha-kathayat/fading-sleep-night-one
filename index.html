<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Phase 1: Setup (Rounded)</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="p-8 bg-slate-50">
    <div class="max-w-md mx-auto bg-white rounded-3xl shadow-lg p-8 border border-slate-100">
        <div class="text-center mb-8">
            <span
                class="bg-indigo-600 text-white text-[10px] font-black px-3 py-1 rounded-full uppercase tracking-widest">Night
                1 & 2</span>
        </div>
        <div class="border-2 border-dashed border-indigo-400 rounded-2xl p-6 text-center space-y-6">
            <div>
                <p class="text-[10px] font-bold text-indigo-400 uppercase tracking-widest">Target Bedtime</p>
                <div id="res-bed" class="text-5xl font-extrabold text-slate-800">--:--</div>
            </div>
            <div>
                <p class="text-[10px] font-bold text-indigo-400 uppercase tracking-widest">Wake Up Time</p>
                <div id="res-wake" class="text-5xl font-extrabold text-slate-800">--:--</div>
            </div>
        </div>
    </div>

    <script>
        const p = new URLSearchParams(window.location.search);
        const tToM = (t) => { if (!t) return 0; const [h, m] = t.split(':').map(Number); return (h * 60) + m; };
        const mToT = (m) => {
            let tm = Math.round(m / 5) * 5; // ROUND TO NEAREST 5
            while (tm < 0) tm += 1440;
            return String(Math.floor(tm / 60) % 24).padStart(2, '0') + ":" + String(tm % 60).padStart(2, '0');
        };

        function calculate() {
            const bBed = p.get('base_bed') || "21:08";
            const bWake = p.get('base_wake') || "09:27";
            const bSol = parseInt(p.get('base_sol') || 0);
            const bWaso = parseInt(p.get('base_waso') || 0);

            // Formula: Bedtime + SOL + WASO + 30
            const targetMins = tToM(bBed) + bSol + bWaso + 30;

            document.getElementById('res-bed').innerText = mToT(targetMins);
            document.getElementById('res-wake').innerText = bWake;
        }
        window.onload = calculate;
    </script>
</body>

</html>